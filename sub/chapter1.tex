\chapter{緒言}
\section{研究動機}\label{section:Motivation}
現代社会は効率化されたオーガズムに溢れている. 技術の発展とともに, 人々は冗長なエンターテイメントを忌避するようになり, より短く, より楽しく, より強い刺激を求めるようになった. 素晴らしいストーリーをただなぞるだけのゲームや, その配信を倍速で見て満足し, 一話目からチートスキルで無双する漫画, 短い話数でまとめられたアニメをタイムパフォーマンス重視で消費する. そのような目的に適わないエンターテイメントは, 現代では生き残ることができないのだろう. 娯楽における思考は脳内リソースの浪費である. 日々に疲弊した現代人には, 余暇では体力を温存して, ただただストレス発散に興じることが気持ち良い. 娯楽における無駄は, 時間の無駄である. 多忙を極める現代人には, 美味しいと評判のものだけをその評判とともにつまみ食いし, フォロワーの多い"あの人"の感想に自分も共感する方が性に合っているのだろう. それにどこかもの寂しさを感じるのは私だけだろうか.

私が幼少期の頃には, 触れる娯楽全てが冗長なものばかりだった. 各人が育った環境によって, 経験したものは異なるだろう. ゲームでも, 漫画でも, アニメでも. みんな無駄な時間を過ごし, 最後のカタルシスをただ待ち望んでいたのだろう.
私にとっての一番の娯楽は, パズルだった. 楽しいとは到底言えない時間をパズルを解くためだけに大量に費やし, 友人の遊びの誘いを断り教室の隅で熱心にパズルを解いていた. 自分の力だけでパズルを解いたその瞬間の達成感は, 何事にも代えがたかったからである. それは, 膨大な思考過程と無駄な時間を積み重ねることでしか得られないものだった. 現代社会を生きているだけでそこまでの達成感を, 娯楽の中で得ることは難しい. ただ, 私は面白いパズルがもう一度解きたいのである. 技術の発展が進めば進むほど, この願望は非現実的なものになり, そのうち私も効率的なカタルシスの闇に飲み込まれていくのだろう. ただでさえ, 幼き私を魅了したパズルは時代遅れだと言わんばかりに本屋の棚の片隅に追いやられている. 社会からその存在が消えてしまうその前に, 私自身が新しいパズルルールを生み出し, 自分の手で面白いパズルを解くためだけにこの研究を始めた. NO PUZZLE, NO LIFE. これが私の研究動機である.

\section{研究背景}\label{section:Introduction}
% パズルは, 世界中で多くの人々を魅了する娯楽の一つである.
% その形態は多岐にわたり, 様々なパズルが研究対象となっている.
% パズルの一つであるペンシルパズルは, 世界で最も人気のパズルジャンルのうちの一つである. ペンシルパズルとは一般に, 以下のパズルのことを言う.
% \begin{quote}
%   図示された問題に対して答えを徐々に書き込むことによって, 最終的な解答を行う形式のパズルのことである. リトゥンパズル（written puzzle）とも呼ばれる. 迷路や, 虫食い算, クロスワードパズル, 数独などが代表的. （文章は \cite{web:PencilPuzzle}から引用. ）
% \end{quote}
% ペンシルパズルは完全情報確定パズルと言われるものの一種であり, その計算量や解法アルゴリズム, あるいは問題の自動作成等については深く研究が進んでいる. しかし一つ抽象度を上げ, ペンシルパズルのパズルルール（以下パズルルール）を自動的に作成したという先行研究が現時点で存在しない. Haahr-de Kegel \cite{Barbara2020}はProcedural content generation（PCG）と呼ばれる, ゲーム性向上のためのゲームコンテンツの手続き的生成に関する調査を行った研究において, 「プレイヤーはゲームをプレイする際に, 同じゲーム性の繰り返しからいわゆるマンネリ化を感じる傾向にある. だが, それらはパズルを導入すれば緩和できる」と述べている. しかし, 一種類のパズルのみではマンネリ化の解消に限界があり, また, 生産コストの点から多種多様なパズルルールを生み出すことは難しい. そこでパズルルールの自動作成が求められている.

\cref{section:Motivation}で触れたように, 本研究はペンシルパズルのパズルルール（以下パズルルール）の自動作成における課題解決のための研究である. ただし, ペンシルパズルとは一般に以下のものを指す.
\begin{quote}
  図示された問題に対して答えを徐々に書き込むことによって, 最終的な解答を行う形式のパズルのことである. リトゥンパズル（written puzzle）とも呼ばれる. 迷路や, 虫食い算, クロスワードパズル, 数独などが代表的. （文章は \cite{web:PencilPuzzle}から引用. ）
\end{quote}
ペンシルパズルは完全情報確定パズルと言われるものの一種であり, その計算量や解法アルゴリズム, あるいは問題の自動作成等については深く研究が進んでいる. しかし一つ抽象度を上げ, ペンシルパズルのパズルルール（以下パズルルール）を自動的に作成したという先行研究が現時点で存在しない.
パズルルールの自動作成における課題としてパズルルールに関し, 先行研究にて統一的な数学的記述の整理がなされていないことが挙げられる. そこで, 本研究の目的はパズルルールを数学的に定義し, それらにまつわる概念を整理することとした.

研究の調査段階において, パズルルールを0から生成した例は確認されていない. 本研究に近しいものとしてBrowne-Maire \cite{Browne2010}は二人有限確定完全情報ゲームを既存のゲームから組み合わせて生成した. しかし, この研究は0からゲームルールを生成したものではなく, 組み合わせたものを新しくゲームルールに採用したものである. また工学的手法で生成しているという点で本研究とは異なる. また, 多くの研究（Iwashita-Kawahara-Minato-Tsumura-Yoshinaka
\cite{Yoshinaka2012}やKoljonen-Mantere \cite{Mantere2007}）にてあるパズルルールが存在したとき, そのパズルルールに則った問題を作成した事例が多数確認されている. しかし, こちらはパズルルールの作成ではなくパズルルールに則った具体的な問題を生成するものであり, 研究としては異なるものである. Herting	 \cite{Herting2004}の研究はスリザーリンクというパズルにおいてのみパズルの盤面と, それが満たすべき条件を数学的に定義し, 問題を効率的に解くためのrule-based approachを行ったものである. これも上記の例と同様に, 本研究とは主旨が異なるものである.



\section{定義}\label{section:IntroDefinition}
本論文における主結果を述べるために, ペンシルパズルにおける種々の概念を簡単に定義する. ただし, 数学的な定義は\cref{chapter:Definition}で行う. \cref{figure:Board}で与えたようなグリッドに対し, 格子点, 細胞, 横辺, 縦辺を\textbf{位置}と呼ぶこととする. ただし, 格子点, 細胞, 横辺, 縦辺は\cref{figure:Board}で与える図中の名称とそれぞれ対応させるものとする. ペンシルパズルではそれぞれの位置には未知と既知という\textbf{状態}が存在し, それらには具体的な値として与えられる. その値が含まれる集合を以下で定義する.
\begin{definition}[\textit{codomain}]
  位置に対応する状態がとりうる集合のことを\textbf{\textit{codomain}}と定義する.
\end{definition}
それらを定義したとき, グリッドにおける各格子点, 細胞, 横辺, 縦辺全てに状態が存在するときに限り, その状態全体を\textbf{盤面}と定義する. \cref{figure:NumberPlaceQuestion}に与えた盤面では, 左上端の細胞の状態が既知であり, その解は8に対応し, 右上端の細胞の状態は未知である（既知の場合解は4）.

そして, パズルルールにおいて盤面が満たすべき条件を以下で定義する.
\begin{definition}[\textit{conditions}]
  全ての位置の状態が既知である盤面を与えたとき, 盤面にある全ての状態が満たしているべき条件を\textbf{\textit{conditions}}と定義する.
\end{definition}

以上のことを踏まえ, 全ての格子点, 細胞, 辺の状態が既知であり, その値がすべて\textit{conditions}を満たしている盤面のことを\textbf{完成盤面}と定義する. ある盤面が存在して, 全ての位置の状態が既知であるときにその解が, パズルルールに定められた条件（\textit{conditions}）に従う完成盤面がただ一つしかない盤面を\textbf{完成可能盤面}と定義する. 以上の記述より, ある完成盤面もまた完成可能盤面である. 完成可能盤面と完成盤面の例として\cref{figure:SlitherLink}を与える. 図中上が完成可能盤面, 図中下が完成盤面である.

上の記述より, 一つの完成盤面には複数の完成可能盤面が対応する. ただし, 一つの操作（状態が未知である位置に対し具体的な解を対応させること）を課した完成可能盤面もまた完成可能盤面となっていることに注意する. このとき, 一つの完成盤面に対応している完成可能盤面の集合全体をパズルルールの\textbf{問題}と定義する. ある問題に含まれる完成可能盤面を, その完成可能盤面に対応する完成盤面へと変換するその操作のことを問題を\textbf{解く}と呼ぶこととする.

\textit{codomain}と\textit{conditions}を用いることで, パズルの問題の完成盤面がこの組み合わせで全て記述できる. ただし, \cref{chapter:Definition}以降では問題と完成盤面という用語をさらに厳密に定義する. 藤原 \cite{Fujiwara2022}によると, 既存のパズルルールにおいては完成盤面から問題を作成することができる. その際に必要になる以下二つの概念を導入する. 藤原 \cite{Fujiwara2022}の手法に従うと, 完成盤面から既知の状態を未知の状態に変換することで問題を作ることができる. そのための概念としてHidden Information（HI）を導入する. また, 問題においては状態が未知であることと既知である状態がソルバーに同一の状態として示される（\cref{figure:SlitherLink}では辺が書かれていない状態と, 未知であることがソルバーに同一の状態として示されている）. その対応を\textit{identification}として導入する. これら二つを以下で定義する. ただし, ここでのソルバーとはあるパズルルールの問題が存在したとき, 問題を解く解答者, あるいは問題を解くアルゴリズムのことを指すこととする.
\begin{definition}[\textit{Hidden Information}（HI）]
  ある完成盤面があったとき, ソルバーから隠す位置の部分集合を\textbf{\textit{Hidden Information}（HI）}と定義する.
\end{definition}
\begin{definition}[\textit{identification}]
  未知の状態と, 既知の状態の具体的な値がソルバーに同一の状態として伝えられるその対応を\textbf{\textit{identification}}として定義する.
\end{definition}

\section{主結果}
上で定義した種々の概念を用いることで, ペンシルパズルに関わる概念を数学的定義により整理した. 本論文ではそれらを用いることにより以下二つのことを説明した.
\subsection*{結果1}
\cref{section:IntroDefinition}で定義した四つの定義を用いて, パズルルールがそれら\textit{codomain}, \textit{conditions}, HI, \textit{identification}の組み合わせで定義されることを主張した（\cref{definition:PuzzleRule}）.

\subsection*{結果2}
既存のパズルルールが本論文でのパズルルールに従っていることを実証した（\cref{section:ExistsPuzzleRule}）.
さらに, 本論文で触れられている\textit{conditions}の具体的な構成方法（\cref{section:ConcreteConditions}）に従うことで新規のパズルルールを作成し, 問題が存在することを実証した（\cref{section:NewPuzzleRule}）.

\section{応用}
この研究の応用先として, 既存のパズルルールを本論文での定義に当てはめ, 精査することにより各パズルルールがどのような性質を持っているかを体系的に整理することができる. また, その性質を分類, 抽象化することにより, それらの性質を持った新規のパズルルールを機械的に作成することが期待される. これはパズルルールの自動作成にかなり近いものである. また, 藤原 \cite{Fujiwara2022}が述べている既存のパズルルールに関する記述（\cref{theorem:AutoGeneration}）を本研究のパズルルールに適用できる条件を解明することができれば, パズルルールを自動作成したのちに具体的な問題を多数作成することも可能になる. これらを実現すれば, \cref{section:Introduction}で触れた他分野に対する応用の実現も期待される.
本論文では\textit{conditions}の構成方法のみに触れているが, HIの構成を変えることでパズルルールが大きく変わることも検証段階では確認されている.

また, この研究により, 関連する分野に対し問題解決における価値を提供することができる. 具体的には, 先に述べた商業用ゲームへの移植や, さらにはネットワークセキュリティへの応用などが考えられる. Liang-Xiao \cite{Liang2013}はネットワークセキュリティに対する問題をゲーム理論的アプローチで考察している. パズルはゲーム理論と密接な関係にあり, 	本研究はこれら分野への応用が期待される.